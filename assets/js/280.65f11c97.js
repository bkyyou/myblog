(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{903:function(s,t,a){"use strict";a.r(t);var n=a(10),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_15-理解函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-理解函数"}},[s._v("#")]),s._v(" 15.理解函数")]),s._v(" "),t("p",[s._v("函数和alias功能类似，都是为了简化操作")]),s._v(" "),t("h2",{attrs:{id:"_15-1-linux-alias-别名功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-1-linux-alias-别名功能"}},[s._v("#")]),s._v(" 15.1.linux alias 别名功能")]),s._v(" "),t("p",[s._v("别名易操作")]),s._v(" "),t("h3",{attrs:{id:"_15-1-1-查看别名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-1-1-查看别名"}},[s._v("#")]),s._v(" 15.1.1.查看别名")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@VM-0-4-centos ~]# alias\nalias cp='cp -i'\nalias egrep='egrep --color=auto'\nalias fgrep='fgrep --color=auto'\nalias grep='grep --color=auto'\nalias l.='ls -d .* --color=auto'\nalias ll='ls -l --color=auto'\nalias ls='ls --color=auto'\nalias mv='mv -i'\nalias rm='rm -i'\nalias which='alias | /usr/bin/which --tty-only --read-alias --show-dot --show-tilde'\n")])])]),t("h3",{attrs:{id:"_15-1-2-定义别名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-1-2-定义别名"}},[s._v("#")]),s._v(" 15.1.2.定义别名")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("MacBook-Pro-7:~ j$ alias ll='ls -l --color=auto'\nMacBook-Pro-7:~ j$ ll\ntotal 5480\n-rw-r--r--    1 j     staff        0  5  9 17:48 1\n-rw-r--r--    1 j     staff        0  5  9 17:48 2\ndrwx------    5 j     staff      160  4 25 15:45 Applications\ndrwx------+  22 j     staff      704  5 12 11:51 Desktop\ndrwx------+   8 j     staff      256  6 24  2022 Documents\ndrwx------+   7 j     staff      224  5 12 12:12 Downloads\ndrwx------@  80 j     staff     2560  5 12 11:52 Library\ndrwx------+   4 j     staff      128  5 12 13:53 Movies\ndrwx------+   4 j     staff      128  5 12 13:53 Music\ndrwx------+   4 j     staff      128  5 12 11:36 Pictures\ndrwxr-xr-x+   5 j     staff      160 12  2  2020 Public\ndrwxr-xr-x    2 j     staff       64 12  6  2021 Sunlogin Files\n-rw-r-----@   1 j     staff  2801136 12 27 15:27 darwin-x64-93_binding.node\ndrwxr-xr-x  115 root  staff     3680 12 27 14:47 node_modules\ndrwxr-xr-x   28 j     staff      896  4 20  2022 nvm\n-rw-r--r--    1 j     staff      475  3 17 14:33 yarn-error.log\ndrwxr-xr-x    3 j     staff       96 10 19  2021 证书\nMacBook-Pro-7:~ j$ \n")])])]),t("h2",{attrs:{id:"_15-2-函数语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-2-函数语法"}},[s._v("#")]),s._v(" 15.2.函数语法")]),s._v(" "),t("blockquote",[t("p",[s._v("函数必须先定义，在调用")])]),s._v(" "),t("p",[s._v("函数如果单独写一个文件，需要 source 读取 (函数的另一种玩法，写入文件中，用于加载)")]),s._v(" "),t("p",[s._v("在函数体中使用 local 定义局部变量")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 简写定义")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("sayHello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 简写定义")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("sayHello")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"返回值"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 标准定义")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("sayHello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"返回值"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行")]),s._v("\nsayHello\n")])])]),t("h3",{attrs:{id:"_15-2-1-return-的作用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-2-1-return-的作用"}},[s._v("#")]),s._v(" 15.2.1.return 的作用")]),s._v(" "),t("p",[s._v("函数里需要添加 return 语句，作用退出函数，且赋予返回值给调用该函数的程序，也就是 shell 脚本(在 shell 脚本中，定义，使用函数，shell脚本执行结束后，通过 $? 获取其 return 的返回值)")]),s._v(" "),t("h3",{attrs:{id:"_15-2-1-return-和-exit-区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-2-1-return-和-exit-区别"}},[s._v("#")]),s._v(" 15.2.1.return 和 exit 区别")]),s._v(" "),t("p",[s._v("return 只能写在 函数体内， exit 是 shell 内置命令，用于退出shell 环境")]),s._v(" "),t("p",[s._v("return 是结束函数的执行，返回一个(退出值、返回值)\nexit 是结束shell环境，返回一个(退出值、返回值) 给当前shell")]),s._v(" "),t("h2",{attrs:{id:"_15-3-函数实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-3-函数实践"}},[s._v("#")]),s._v(" 15.3.函数实践")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('[root@VM-0-4-centos test_scripts]# vim learn_func\n[root@VM-0-4-centos test_scripts]# ls /tmp | grep "music.txt"\n[root@VM-0-4-centos test_scripts]# ls /tmp | grep "music.txt" | wc -l\n0\n')])])]),t("h2",{attrs:{id:"_15-3-1-函数实践1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-3-1-函数实践1"}},[s._v("#")]),s._v(" 15.3.1.函数实践1")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# learn_fun")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("createfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /tmp/\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我准备创建一个文件，且写入信息"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" ./music.txt\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncreatefile\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('# source 会把脚本中变量加载到当前 shell 中， 应该用 bash 执行\n[root@VM-0-4-centos test_scripts]# source learn_func \n我准备创建一个文件，且写入信息\n[root@VM-0-4-centos tmp]# ls /tmp | grep "music.txt" | wc -l\n1\n[root@VM-0-4-centos tmp]# cat /tmp/music.txt  -n\n     1\thello world\n[root@VM-0-4-centos tmp]# \n')])])]),t("h2",{attrs:{id:"_15-3-2-函数实践2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-3-2-函数实践2"}},[s._v("#")]),s._v(" 15.3.2.函数实践2")]),s._v(" "),t("p",[s._v("函数定义在文件中，只定义，不执行")]),s._v(" "),t("p",[s._v("另外一个脚本，读取该函数文件，且加载该函数")]),s._v(" "),t("p",[s._v("source 退出当前 shell ，变量消失")]),s._v(" "),t("ul",[t("li",[s._v("手动加载")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('[root@VM-0-4-centos test_scripts]# vim my_func.sh\n[root@VM-0-4-centos test_scripts]# set |grep ^chao\n[root@VM-0-4-centos test_scripts]# source my_func.sh \n[root@VM-0-4-centos test_scripts]# source my_func.sh \n[root@VM-0-4-centos test_scripts]# set |grep ^chao\nchao () \n[root@VM-0-4-centos test_scripts]# cat my_func.sh \n#!/bin/bash\n\nchao(){\n  echo "我是函数，我被执行"\n}\n\n[root@VM-0-4-centos test_scripts]# \n')])])]),t("ul",[t("li",[s._v("函数加载")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[root@VM-0-4-centos test_scripts]# vim fun3.sh \n[root@VM-0-4-centos test_scripts]# bash fun3.sh \n[root@VM-0-4-centos test_scripts]# chao\n-bash: chao: 未找到命令\n[root@VM-0-4-centos test_scripts]# source fun3.sh \n[root@VM-0-4-centos test_scripts]# chao\n我是函数，我被执行\n[root@VM-0-4-centos test_scripts]# set | grep chao\n_=chao\nchao () \n[root@VM-0-4-centos test_scripts]# cat chao\ncat: chao: 没有那个文件或目录\n[root@VM-0-4-centos test_scripts]# cat fun3.sh \n#!/bin/bash\n\n[ -f /shell_program/test_scripts/my_func.sh ] && . /shell_program/test_scripts/my_func.sh || exit\n[root@VM-0-4-centos test_scripts]# \n")])])]),t("blockquote",[t("p",[s._v("有关 source 和 bash 是否开启子 shell， 且在当前 shell 环境中加载函数的一个深入理解")])]),s._v(" "),t("h2",{attrs:{id:"_15-4-函数脚本传入参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-4-函数脚本传入参数"}},[s._v("#")]),s._v(" 15.4.函数脚本传入参数")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("#!/bin/bash\n\n[ -f /shell_program/test_scripts/my_func.sh ] && . /shell_program/test_scripts/my_func.sh || exit\n\nchao $1 $2 $3\n")])])]),t("h2",{attrs:{id:"_15-5-函数脚本开发-检测网站活性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-5-函数脚本开发-检测网站活性"}},[s._v("#")]),s._v(" 15.5.函数脚本开发： 检测网站活性")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$#")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ne")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Usage: '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(' url"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 利用 wget 命令测试 url 是否正常")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--spider")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" /dev/null "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tries")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-T")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对状态码判断，网站是否正常")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-eq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(' is running..."')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(' is down..."')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])])]),t("h2",{attrs:{id:"_15-6-开发-rsync-管理脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-6-开发-rsync-管理脚本"}},[s._v("#")]),s._v(" 15.6.开发 rsync 管理脚本")]),s._v(" "),t("p",[s._v("/etc/init.d 服务启停管理脚本，参考之前的")])])}),[],!1,null,null,null);t.default=r.exports}}]);