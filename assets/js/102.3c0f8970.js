(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{562:function(t,a,n){t.exports=n.p+"assets/img/17.2.38853cd3.png"},906:function(t,a,n){"use strict";n.r(a);var r=n(10),s=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_17-【linux】-定时任务调度详解-crontab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-【linux】-定时任务调度详解-crontab"}},[t._v("#")]),t._v(" 17.【Linux】 定时任务调度详解(crontab)")]),t._v(" "),a("h2",{attrs:{id:"_17-1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-1-概述"}},[t._v("#")]),t._v(" 17.1.概述")]),t._v(" "),a("p",[t._v("crontab命令用于设置周期性被执行的指令。该命令从标准输入设备读取指令，并将 其存放于“crontab”文件中，以供之后读取和执行。")]),t._v(" "),a("p",[t._v("可以使用crontab定时处理离线任务，比如每天凌晨2点更新数据等，经常用于系统 任务调度。")]),t._v(" "),a("h2",{attrs:{id:"_17-2-服务启动和关闭"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-2-服务启动和关闭"}},[t._v("#")]),t._v(" 17.2.服务启动和关闭")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("一般Linux系统中都会装有 crontab ，如果没有安装可以使用下面的命令安装：\n\nyum -y install crontabs\n\ncrontab 服务的启动和关闭命令如下：\n\ncentos7服务管理命令，centos7之前版本使用service管理\n\nsystemctl start crond     # 启动服务\n\nsystemctl stop crond     # 关闭服务\n\nsystemctl restart crond  # 重启服务\n\nsystemctl reload crond  # 重新载入配置\n\nsystemctl status crond   # 查看crontab服务状态 #\n\n可以使用下面的命令加入开机启动 systemctl enable crond\n")])])]),a("h2",{attrs:{id:"_17-3-服务启动和关闭"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-3-服务启动和关闭"}},[t._v("#")]),t._v(" 17.3.服务启动和关闭")]),t._v(" "),a("p",[t._v("任务调度全局配置 crontab 全局任务调度配置在如下的目录：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("文件")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("cron.daily/")]),t._v(" "),a("td",[t._v("是每天执行一次的job")])]),t._v(" "),a("tr",[a("td",[t._v("cron.weekly/")]),t._v(" "),a("td",[t._v("是每个星期执行一次的job")])]),t._v(" "),a("tr",[a("td",[t._v("cron.monthly/")]),t._v(" "),a("td",[t._v("是每月执行一次的job")])]),t._v(" "),a("tr",[a("td",[t._v("cron.hourly/")]),t._v(" "),a("td",[t._v("是每个小时执行一次的job")])]),t._v(" "),a("tr",[a("td",[t._v("cron.d/")]),t._v(" "),a("td",[t._v("是系统自动定期需要做的任务")])]),t._v(" "),a("tr",[a("td",[t._v("crontab")]),t._v(" "),a("td",[t._v("是设定定时任务执行文件")])]),t._v(" "),a("tr",[a("td",[t._v("cron.deny")]),t._v(" "),a("td",[t._v("文件就是用于控制不让哪些用户使用Crontab的功能")])])])]),t._v(" "),a("h2",{attrs:{id:"_17-4-用户配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-4-用户配置文件"}},[t._v("#")]),t._v(" 17.4.用户配置文件")]),t._v(" "),a("p",[t._v("每个用户都有自己的 crontab 配置文件，使用 crontab -e 命令进行编辑。保存后系 统会自动存放与 /var/spool/cron/ 目录中，文件以用户名命名。")]),t._v(" "),a("p",[t._v("linux的 crontab 服务每隔一分钟去读取一 次 /var/spool/cron , /etc/crontab , /etc/cron.d 下面所有的内容。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("crontab命令一览：\ncrontab -e : 编辑当前用户的定时任务列表\ncrontab -l : 查看当前用户的定时任务列表\ncrontab -r : 删除当前用户的定时任务列表\n")])])]),a("h2",{attrs:{id:"_17-5-crontab定时任务格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-5-crontab定时任务格式"}},[t._v("#")]),t._v(" 17.5.crontab定时任务格式")]),t._v(" "),a("p",[t._v("crontab每一条记录为一个定时任务，定时人遵循相应的定义规则。")]),t._v(" "),a("p",[a("img",{attrs:{src:n(562),alt:"crontab定时任务格式"}})]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("其中前面的5个星号表示的含义如下：\n\nminute ：表示分钟，可以是从0到59之间的任何整数。\nhour ：表示小时，可以是从0到23之间的任何整数。\nday ：表示日期，可以是从1到31之间的任何整数。\nmonth ：表示月份，可以是从1到12之间的任何整数。\nweek ：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。command ：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。\n每一个星号部分可用下面的特殊符号：\n\n星号（*）：通配符匹配，代表所有可能的值。\n逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”。\n中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示 “2,3,4,5,6”。\n正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执 行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段， 表示每十分钟执行一次。\n")])])]),a("h2",{attrs:{id:"_17-5-crontab定时任务实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-5-crontab定时任务实例"}},[t._v("#")]),t._v(" 17.5.crontab定时任务实例")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('下面列举常用的时间频次示例。\n\n00 05 * * * : 每天凌晨5点执行\n20 12 1,10,20 * * : 每个月的1号，10号，20号的12:20执行\n10 1 * * 6,0 : 表示每周六、周日的1:10分执行\n0,30 18-23 * * * : 每天18:00至23:00之间每隔30分钟执行\n0 23-7/1 * * * : 晚上11点到早上7点之间，每隔一小时执行\n0 6-12/3 * 10 * : 每年10月的每天早上6点到12点每隔3个小时执行一次\n30 17 * * 1-5 : 周一到周五下午5点30分执行一次 0 */2 * * * ：每两个小时执行一次\n例如：\n\n每隔一分钟打印一次时间\n\n* * * * * echo "echo `date`" >> ~/1.txt\n')])])]),a("h2",{attrs:{id:"_17-6-输入输出重定向"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-6-输入输出重定向"}},[t._v("#")]),t._v(" 17.6.输入输出重定向")]),t._v(" "),a("p",[t._v("在上面更新数据定时任务的实例中，如果执行的时候有错误信息输出，会输出到哪儿呢？")]),t._v(" "),a("p",[t._v("例如：每隔一分钟列出/root下和/aaa下的目录和文件；因为/aaa目录不存在所以会报错")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("* * * * * ls /root /asss >> ~/1.txt 2>&1\n")])])]),a("h2",{attrs:{id:"_17-7-时间处理-将每天的日志输入到不同的文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-7-时间处理-将每天的日志输入到不同的文件"}},[t._v("#")]),t._v(" 17.7.时间处理 (将每天的日志输入到不同的文件)")]),t._v(" "),a("p",[t._v("再回顾上面的更新任务，它是将每一天的运行结果都重定向到 update.log 文件，如 果输出比较多，我们就需要每一天输出的不同的文件，可以通过在输出目录中指定日 期用来分割。如下：")]),t._v(" "),a("p",[t._v("date 函数中的 % 需要转义。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('30 12 * * * echo "echo `date`" >> ~/"time_`date +\\%Y\\%m\\%d`.txt"\n')])])]),a("p",[t._v("每天12：30都打印时间到当天的文件里，比如今天是8月5号，8月6号就有一个文件：")]),t._v(" "),a("p",[t._v("原文链接：https://blog.csdn.net/weixin_65690979/article/details/126176083")])])}),[],!1,null,null,null);a.default=s.exports}}]);