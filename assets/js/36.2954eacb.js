(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{517:function(a,t,e){a.exports=e.p+"assets/img/2.9.84fdf0c9.jpg"},518:function(a,t,e){a.exports=e.p+"assets/img/2.10.9a35ea89.jpg"},755:function(a,t,e){"use strict";e.r(t);var s=e(29),n=Object(s.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"_3-练习"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-练习"}},[a._v("#")]),a._v(" 3.练习")]),a._v(" "),s("h2",{attrs:{id:"_1-部署-nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-部署-nginx"}},[a._v("#")]),a._v(" 1. 部署 nginx")]),a._v(" "),s("ol",[s("li",[a._v("搜索镜像")])]),a._v(" "),s("p",[a._v("建议去 dockerhub 搜索")]),a._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("p",[a._v("下载镜像")])]),a._v(" "),s("li",[s("p",[a._v("运行镜像")])])]),a._v(" "),s("p",[a._v("docker run -d --name nginx01 -p 3344:80 nginx")]),a._v(" "),s("p",[a._v("-d 后台运行\n--name  给容器起名字\n-p  宿主机端口:容器内部端口")]),a._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[a._v("本机自测")])]),a._v(" "),s("p",[a._v("curl localhost:3344")]),a._v(" "),s("p",[s("img",{attrs:{src:e(517),alt:""}})]),a._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[a._v("进入容器")])]),a._v(" "),s("div",{staticClass:"language-s extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[root@VM-0-4-centos ~]# docker exec -it nginx01 /bin/bash\nroot@76d489c2c054:/# \n")])])]),s("ol",{attrs:{start:"6"}},[s("li",[s("p",[a._v("查找配置文件\nroot@76d489c2c054:/# whereis nginx\nnginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx")])]),a._v(" "),s("li",[s("p",[a._v("进入配置文件\nroot@76d489c2c054:/# cd /etc/nginx\nroot@76d489c2c054:/etc/nginx# ls\nconf.d  fastcgi_params  koi-utf  koi-win  mime.types  modules  nginx.conf  scgi_params  uwsgi_params  win-utf\nroot@76d489c2c054:/etc/nginx#")])])]),a._v(" "),s("p",[s("strong",[a._v("思考")]),a._v("\n我们每次改动 nginx 配置文件都需要进入容器内部？十分的麻烦，我们要是可以在容器外部提供一个映射路径，达到在容器修改文件名，容器内部就可以自动修改？ -v 卷技术")]),a._v(" "),s("h3",{attrs:{id:"测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[a._v("#")]),a._v(" 测试")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('# 搜索镜像\n[root@VM-0-4-centos home]# docker search nginx\nNAME                               DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\nnginx                              Official build of Nginx.                        14892     [OK]       \njwilder/nginx-proxy                Automated Nginx reverse proxy for docker con…   2030                 [OK]\nricharvey/nginx-php-fpm            Container running Nginx + PHP-FPM capable of…   814                  [OK]\n...\n\n# 下载镜像\n[root@VM-0-4-centos home]# docker pull nginx\nUsing default tag: latest\nlatest: Pulling from library/nginx\n69692152171a: Pull complete \n49f7d34d62c1: Pull complete \n5f97dc5d71ab: Pull complete \ncfcd0711b93a: Pull complete \nbe6172d7651b: Pull complete \nde9813870342: Pull complete \nDigest: sha256:df13abe416e37eb3db4722840dd479b00ba193ac6606e7902331dcea50f4f1f2\nStatus: Downloaded newer image for nginx:latest\ndocker.io/library/nginx:latest\n[root@VM-0-4-centos home]# \n\n# 运行镜像\n[root@VM-0-4-centos ~]# docker run -d --name nginx01 -p 3344:80 nginx\n76d489c2c054705183e647ddc58a304bc2585516cebd39c784cdf00727f89439\n\n# 本机自测\n[root@VM-0-4-centos ~]# curl localhost:3344\n<!DOCTYPE html>\n<html>\n<head>\n<title>Welcome to nginx!</title>\n<style>\n    body {\n        width: 35em;\n        margin: 0 auto;\n        font-family: Tahoma, Verdana, Arial, sans-serif;\n    }\n</style>\n</head>\n<body>\n<h1>Welcome to nginx!</h1>\n<p>If you see this page, the nginx web server is successfully installed and\nworking. Further configuration is required.</p>\n\n<p>For online documentation and support please refer to\n<a href="http://nginx.org/">nginx.org</a>.<br/>\nCommercial support is available at\n<a href="http://nginx.com/">nginx.com</a>.</p>\n\n<p><em>Thank you for using nginx.</em></p>\n</body>\n</html>\n[root@VM-0-4-centos ~]# \n')])])]),s("p",[a._v("http:1.11.111.111:3344  ip + 端口")]),a._v(" "),s("h2",{attrs:{id:"_2-部署-tomcat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-部署-tomcat"}},[a._v("#")]),a._v(" 2. 部署 tomcat")]),a._v(" "),s("h3",{attrs:{id:"官方的使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#官方的使用"}},[a._v("#")]),a._v(" 官方的使用")]),a._v(" "),s("p",[a._v("docker run -it --rm tomcat:9.0")]),a._v(" "),s("p",[a._v("我们之前的启动都是后台，停止了容器之后，容器还是可以查到。\ndocker run -it --rm , 一般用来测试，用完删除")]),a._v(" "),s("h3",{attrs:{id:"运行-tomcat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行-tomcat"}},[a._v("#")]),a._v(" 运行 tomcat")]),a._v(" "),s("p",[a._v("docker run -d -p 3355:8080 --name tomcat01  tomcat")]),a._v(" "),s("h3",{attrs:{id:"测试访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试访问"}},[a._v("#")]),a._v(" 测试访问")]),a._v(" "),s("p",[a._v("http:1.11.111.111:3355")]),a._v(" "),s("p",[a._v("此时显示 404 ， 现在来看是正常的")]),a._v(" "),s("h3",{attrs:{id:"进入容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进入容器"}},[a._v("#")]),a._v(" 进入容器")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[root@VM-0-4-centos ~]# docker exec -it tomcat02 /bin/bash\nroot@e1b18aa33c8b:/usr/local/tomcat# ls\nBUILDING.txt  CONTRIBUTING.md  LICENSE  NOTICE  README.md  RELEASE-NOTES  RUNNING.txt  bin  conf  lib  logs  native-jni-lib  temp  webapps  webapps.dist  work\n")])])]),s("ul",[s("li",[s("ol",[s("li",[a._v("发现问题")])]),a._v(" "),s("ul",[s("li",[a._v("Linux 命令少了")]),a._v(" "),s("li",[a._v("没有 webapps")])])])]),a._v(" "),s("p",[a._v("阿里云镜像的原因，默认是最小的镜像，所以不必要的都剔除掉。保证最小可运行环境")]),a._v(" "),s("p",[a._v("可以将 webapps.dist 下的文件复制到 webapps 中, 暂时实现看到网页的效果")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("root@e1b18aa33c8b:/usr/local/tomcat# cd webapps.dist/\nroot@e1b18aa33c8b:/usr/local/tomcat/webapps.dist# ls\nROOT  docs  examples  host-manager  manager\nroot@e1b18aa33c8b:/usr/local/tomcat/webapps.dist# cd ../\nroot@e1b18aa33c8b:/usr/local/tomcat# cp -r webapps.dist/* webapps\n")])])]),s("h3",{attrs:{id:"问题思考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题思考"}},[a._v("#")]),a._v(" 问题思考")]),a._v(" "),s("p",[a._v("我们以后要部署容器，如果每次都要进入容器是不是很麻烦？要是可以在容器外部提供一个映射路径，达到在容器里修改文件名, webapps, 我们在外部放置项目，可以自动同步到内部就好了")]),a._v(" "),s("h2",{attrs:{id:"部署-es-kibana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署-es-kibana"}},[a._v("#")]),a._v(" 部署 es + kibana")]),a._v(" "),s("p",[a._v("es 暴露的端口很多，十分消耗内存，数据一般需要放置到安全目录，挂载。")]),a._v(" "),s("h3",{attrs:{id:"下载启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载启动"}},[a._v("#")]),a._v(" 下载启动")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('# 下载启动\n\x3c!-- docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2 --\x3e\n\ndocker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2\n')])])]),s("p",[a._v("--net somenetwork ?? 网络配置，这暂时不用")]),a._v(" "),s("h3",{attrs:{id:"测试连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试连接"}},[a._v("#")]),a._v(" 测试连接")]),a._v(" "),s("p",[a._v("es 是成功的")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('[root@VM-0-4-centos ~]# curl localhost:9200\n{\n  "name" : "660fbe3dad7a",\n  "cluster_name" : "docker-cluster",\n  "cluster_uuid" : "_qnzzqYRSsKqjA4-X8fLHw",\n  "version" : {\n    "number" : "7.6.2",\n    "build_flavor" : "default",\n    "build_type" : "docker",\n    "build_hash" : "ef48eb35cf30adf4db14086e8aabd07ef6fb113f",\n    "build_date" : "2020-03-26T06:34:37.794943Z",\n    "build_snapshot" : false,\n    "lucene_version" : "8.4.0",\n    "minimum_wire_compatibility_version" : "6.8.0",\n    "minimum_index_compatibility_version" : "6.0.0-beta1"\n  },\n  "tagline" : "You Know, for Search"\n}\n')])])]),s("h4",{attrs:{id:"启动命令之后遇到的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动命令之后遇到的问题"}},[a._v("#")]),a._v(" 启动命令之后遇到的问题")]),a._v(" "),s("p",[a._v("使用docker 出现Error response from daemon: Conflict. The container name “***” is already in use\n解决方法：\n（1）给容器换一个名字, 比如说 docker run -it --name=mycentos2 centos:7 /bin/bash, 可以解决问题.\n（2）将原来的容器删除")]),a._v(" "),s("p",[a._v("查询当前容器：docker container ls -all")]),a._v(" "),s("p",[a._v("删除当前容器：docker container rm mycentos (提示: 这一步要确定删除容器没问题的情况下, 才可以做)")]),a._v(" "),s("h3",{attrs:{id:"查看状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看状态"}},[a._v("#")]),a._v(" 查看状态")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[root@VM-0-4-centos ~]# docker stats\nCONTAINER ID   NAME            CPU %     MEM USAGE / LIMIT     MEM %     NET I/O           BLOCK I/O       PIDS\n660fbe3dad7a   elasticsearch   0.18%     1.241GiB / 1.795GiB   69.13%    1.88kB / 1.76kB   256MB / 729kB   44\n")])])]),s("h3",{attrs:{id:"问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),s("p",[a._v("启动之后 linux 就卡了")]),a._v(" "),s("p",[a._v("docker stats  查看 cpu 的状态")]),a._v(" "),s("h3",{attrs:{id:"解决"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#解决"}},[a._v("#")]),a._v(" 解决")]),a._v(" "),s("p",[a._v("增加内存的限制， 修改配置文件 -e 配置修改")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('docker run -d --name elasticsearch02 -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m" elasticsearch:7.6.2\n')])])]),s("ul",[s("li",[a._v("测试结果")])]),a._v(" "),s("p",[a._v("docker stats")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("CONTAINER ID   NAME              CPU %     MEM USAGE / LIMIT     MEM %     NET I/O           BLOCK I/O       PIDS\n8d4a7b0a60b1   elasticsearch02   25.45%    395.3MiB / 1.795GiB   21.51%    2.07kB / 1.89kB   105MB / 729kB   44\n^C\n")])])]),s("h2",{attrs:{id:"使用-kibana-连接-es-思考网络怎样才能连接过去"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-kibana-连接-es-思考网络怎样才能连接过去"}},[a._v("#")]),a._v(" 使用 kibana 连接 es ？ 思考网络怎样才能连接过去")]),a._v(" "),s("p",[s("img",{attrs:{src:e(518),alt:"kibana和es网络连接"}})]),a._v(" "),s("h2",{attrs:{id:"我的-myblog-上传到服务器上"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#我的-myblog-上传到服务器上"}},[a._v("#")]),a._v(" 我的 myblog 上传到服务器上")]),a._v(" "),s("p",[a._v("/var/lib/docker/volumes/tomcat01/webapps:/usr/local/tomcat/webapps/ROOT")]),a._v(" "),s("div",{staticClass:"language-s extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("docker run -d -p 8080:8080 --name myblog -v /var/lib/docker/volumes/tomcat01/webapps:/usr/local/tomcat/webapps/ROOT/myblog tomcat\n")])])]),s("h2",{attrs:{id:"部署react项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署react项目"}},[a._v("#")]),a._v(" 部署react项目")]),a._v(" "),s("div",{staticClass:"language-s extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("docker run -d -p 8081:8080 --name reactweb -v /var/lib/docker/volumes/tomcat02/webapps:/usr/local/tomcat/webapps/ROOT tomcat\n\ndocker run -d -p 8082:8080 --name xiaoxiannv -v /var/lib/docker/volumes/tomcat03/webapps:/usr/local/tomcat/webapps/ROOT tomcat\n\n")])])]),s("h2",{attrs:{id:"部署node项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署node项目"}},[a._v("#")]),a._v(" 部署node项目")]),a._v(" "),s("h3",{attrs:{id:"构建命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#构建命令"}},[a._v("#")]),a._v(" 构建命令")]),a._v(" "),s("p",[a._v("docker build -t node-web-app .")]),a._v(" "),s("p",[a._v("docker run --name mynodepm2 -d -v /data/koa-admin:/home/Service -p 3000:4008 test_nodepm2")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("当前使用\ndocker run --name mynode -d -v /data/koa-admin:/home/Service -p 3000:4008 node-web-app")])]),a._v(" "),s("li",[s("p",[a._v("构建运行\ndocker build -t nodeservice .")])])]),a._v(" "),s("p",[a._v("docker run --name mynode -d -v /data/koa-admin:/compImg/service -p 3000:4008 nodeservice")]),a._v(" "),s("ul",[s("li",[a._v("这个才行，TODO？？？ 为啥\ndocker run --name mynode -d -v /data/koa-admin:/home/Service -p 3000:4008 nodeservice")])]),a._v(" "),s("p",[a._v("docker run --name mynodepm2compimg -d -v /data/koa-admin:/compImg/service -p 3000:4008 comp-img")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("项目位置\n/data/ 下")])]),a._v(" "),s("li",[s("p",[a._v("借鉴-直接使用 node 启动\nhttps://www.cnblogs.com/jlmx/p/11731322.html")])])]),a._v(" "),s("h2",{attrs:{id:"pm2-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pm2-使用"}},[a._v("#")]),a._v(" pm2 使用")]),a._v(" "),s("h2",{attrs:{id:"安装-nodejs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-nodejs"}},[a._v("#")]),a._v(" 安装 nodejs")]),a._v(" "),s("p",[a._v("存放地址 /etc/software")]),a._v(" "),s("p",[a._v("https://www.cnblogs.com/mmzuo-798/p/11190244.html")]),a._v(" "),s("p",[a._v("移动文件")]),a._v(" "),s("p",[a._v("mv /etc/node-v16.3.0-linux-x64.tar.xz /app/software/")]),a._v(" "),s("ul",[s("li",[a._v("安装 git")])]),a._v(" "),s("ol",[s("li",[a._v("查看linux版本信息：")])]),a._v(" "),s("p",[a._v("$ cat /etc/redhat-release")]),a._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[a._v("输入命令安装git：")])]),a._v(" "),s("p",[a._v("$ yum install git")]),a._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[a._v("等待下载，自动安装完毕，查看git版本")])]),a._v(" "),s("p",[a._v("$ git --version")]),a._v(" "),s("p",[a._v("安装完毕。")]),a._v(" "),s("ul",[s("li",[a._v("git clone 没有权限")])]),a._v(" "),s("p",[a._v("TODO 解决权限，还没尝试")]),a._v(" "),s("ul",[s("li")]),a._v(" "),s("p",[a._v("https://www.cnblogs.com/keketoloveme/p/14631574.html")]),a._v(" "),s("ul",[s("li",[a._v("在Docker容器中使用Nginx实现反向代理")])]),a._v(" "),s("ol",[s("li",[a._v("https://blog.csdn.net/qq_40369435/article/details/91353244")]),a._v(" "),s("li",[a._v("https://www.cnblogs.com/dotnet261010/p/12596185.html")])]),a._v(" "),s("h2",{attrs:{id:"jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[a._v("#")]),a._v(" jenkins")]),a._v(" "),s("p",[a._v("https://blog.csdn.net/wgl04193410/article/details/108615795")]),a._v(" "),s("p",[a._v("53074237779d4f15abd1ed70397af488")])])}),[],!1,null,null,null);t.default=n.exports}}]);