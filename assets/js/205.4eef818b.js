(window.webpackJsonp=window.webpackJsonp||[]).push([[205],{795:function(_,v,e){"use strict";e.r(v);var r=e(10),t=Object(r.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"_3-从输入-url-到页面呈现的全过程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-从输入-url-到页面呈现的全过程"}},[_._v("#")]),_._v(" 3.从输入 URL 到页面呈现的全过程")]),_._v(" "),v("h2",{attrs:{id:"_3-1-用户在浏览器中输入url地址"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-用户在浏览器中输入url地址"}},[_._v("#")]),_._v(" 3.1.用户在浏览器中输入url地址")]),_._v(" "),v("h2",{attrs:{id:"_3-2-浏览器解析域名得到服务器ip地址"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-浏览器解析域名得到服务器ip地址"}},[_._v("#")]),_._v(" 3.2.浏览器解析域名得到服务器ip地址")]),_._v(" "),v("p",[_._v("浏览器会首先从缓存中找是否存在域名，如果存在就直接取出对应的ip地址，如果没有就开启一个DNS域名解析器。DNS域名解析器会首先访问顶级域名服务器，将对应的ip发给客户端；然后访问根域名解析器，将对应的ip发给客户端；最后访问本地域名服务器，得到最终的ip地址。")]),_._v(" "),v("h2",{attrs:{id:"_3-3-tcp三次握手建立客户端和服务器的连接"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-tcp三次握手建立客户端和服务器的连接"}},[_._v("#")]),_._v(" 3.3.TCP三次握手建立客户端和服务器的连接")]),_._v(" "),v("p",[_._v("因为HTTP是基于TCP的可靠传输，所以在发送http数据报之前，需要先进行TCP的三次握手建立连接。三次握手过程如下：")]),_._v(" "),v("p",[_._v("第一次握手：客户端---\x3e服务端 ack=1,seq=x（x随机生成）")]),_._v(" "),v("p",[_._v("第二次握手：服务端---\x3e客户端 ACK=1,ack=x+1,seq=y（y随机生成）")]),_._v(" "),v("p",[_._v("第三次握手：客户端---\x3e服务端 ACK=1,ack=y+1,seq=x+1")]),_._v(" "),v("p",[_._v("完成第三次握手时，实际上客户端已经与服务器建立了连接，所以第三次握手的报文已经可以携带数据了。")]),_._v(" "),v("h2",{attrs:{id:"_3-4-客户端发送http请求获取服务器端的静态资源"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-客户端发送http请求获取服务器端的静态资源"}},[_._v("#")]),_._v(" 3.4.客户端发送HTTP请求获取服务器端的静态资源")]),_._v(" "),v("h2",{attrs:{id:"_3-5-服务器发送http响应报文给客户端-客户端获取到页面静态资源"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-服务器发送http响应报文给客户端-客户端获取到页面静态资源"}},[_._v("#")]),_._v(" 3.5.服务器发送HTTP响应报文给客户端，客户端获取到页面静态资源")]),_._v(" "),v("h2",{attrs:{id:"_3-6-tcp四次挥手关闭客户端和服务器的连接"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-tcp四次挥手关闭客户端和服务器的连接"}},[_._v("#")]),_._v(" 3.6.TCP四次挥手关闭客户端和服务器的连接")]),_._v(" "),v("p",[_._v("数据传输完毕后，TCP会进行四次挥手断开连接，释放资源。四次挥手过程如下：")]),_._v(" "),v("p",[_._v("第一次挥手：客户端---\x3e服务器 FIN=1,ack=1,seq=u 客户端状态变为FIN_WAIT_1")]),_._v(" "),v("p",[_._v("第二次挥手：服务器---\x3e客户端 ACK=1,ack=u+1,seq=v 服务器状态变为CLOSE_WAIT，TCP进入半关闭状态")]),_._v(" "),v("p",[_._v("第三次挥手：服务器---\x3e客户端 FIN=1,ACK=1,ack=u+1,seq=w 服务器状态变为LAST_ACK")]),_._v(" "),v("p",[_._v("第四次挥手：客户端---\x3e服务器 ACK=1,ack=w+1,seq=u+1 客户端状态变为TIME_WAIT，此时TCP未释放，需要等待计时器计时完成后，客户端状态变为CLOSED")]),_._v(" "),v("h2",{attrs:{id:"_3-7-浏览器解析文档资源并渲染页面"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-7-浏览器解析文档资源并渲染页面"}},[_._v("#")]),_._v(" 3.7.浏览器解析文档资源并渲染页面")]),_._v(" "),v("p",[_._v("浏览器解析文档资源并渲染页面流程：")]),_._v(" "),v("p",[_._v("（1）解析html资源，构建DOM Tree")]),_._v(" "),v("p",[_._v("（2）解析css资源，构建CSS Rule Tree")]),_._v(" "),v("p",[_._v("（3）JS通过DOM API和CSS OM API来操作DOM Tree和CSS Tree")]),_._v(" "),v("p",[_._v("（4）解析完成后综合DOM Tree和CSS Tree会生成Render Tree，计算每个元素的位置，这个过程就是回流（layout or reflow）")]),_._v(" "),v("p",[_._v("（5）调用操作系统Native GUI的绘制")]),_._v(" "),v("p",[_._v("（6）页面绘制完成")]),_._v(" "),v("p",[_._v("涉及到的其他知识点：\n1、Render Tree的生成")]),_._v(" "),v("p",[_._v("DOM Tree和CSS Tree结合会生成Render Tree，是由可视化元素按照其顺序生成的树形结构，非可视化元素是不会出现到渲染树中的。")]),_._v(" "),v("p",[_._v("非可视化元素：head、display：none；（注意：visibility：hidden的元素会出现在渲染树中）")]),_._v(" "),v("p",[_._v("2、回流和重绘")]),_._v(" "),v("p",[_._v("回流（reflow，也叫重排、布局）：某部分的变化影响了布局，浏览器需要重新渲染。（如元素大小、位置的改变）")]),_._v(" "),v("p",[_._v("重绘（repaint）：元素的某一部分发生改变，尺寸、位置没有改变。（字体颜色、背景颜色的改变）")]),_._v(" "),v("p",[_._v("引起回流的几个主要原因：")]),_._v(" "),v("p",[_._v("（1）网页初始化")]),_._v(" "),v("p",[_._v("（2）JS操作DOM树（增加、删除元素等）")]),_._v(" "),v("p",[_._v("（3）某些元素的尺寸改变")]),_._v(" "),v("p",[_._v("（4）CSS属性的改变")]),_._v(" "),v("p",[_._v("浏览器的“dirty”系统：")]),_._v(" "),v("p",[_._v("为了避免页面细小的改变就引起回流和重绘，“dirty”系统会将这些改变操作积攒一批再进行操作，这又叫异步reflow或者增量异步reflow。有些特殊情况不会这么做：resize窗口、改变了页面默认的字体等，这些操作会直接触发回流。")]),_._v(" "),v("p",[_._v("编写代码时如何减少回流和重绘：")]),_._v(" "),v("p",[_._v("（1）修改样式不要逐条修改，定义CSS样式的class，直接修改元素的className")]),_._v(" "),v("p",[_._v("（2）不要将DOM节点的属性值放在循环中当成循环的变量")]),_._v(" "),v("p",[_._v("（3）为动画的HTML元素使用fixed或absolute的position属性，修改它们的CSS就不会触发reflow")]),_._v(" "),v("p",[_._v("（4）把DOM离线后修改，设置display：none或者clone元素到内存中，修改完成再显示回页面")]),_._v(" "),v("p",[_._v("（5）不要使用table布局，一个微小的改变就可能引起整个table的重新布局")]),_._v(" "),v("p",[_._v("3、性能优化")]),_._v(" "),v("p",[_._v("（1）提升HTML的加载速度")]),_._v(" "),v("ul",[v("li",[v("p",[_._v("页面精简，删除不必要的内容，将内嵌的JS和CSS移至外部文件，使用压缩工具等")])]),_._v(" "),v("li",[v("p",[_._v("减少文件数量，合并文件，减少请求次数")])]),_._v(" "),v("li",[v("p",[_._v("减少域名查询，外部引入的资源尽量少使用不同的域名")])]),_._v(" "),v("li",[v("p",[_._v("使用缓存，重用数据")])]),_._v(" "),v("li",[v("p",[_._v("优化页面元素的加载顺序")])]),_._v(" "),v("li",[v("p",[_._v("使用合法的标签")])]),_._v(" "),v("li",[v("p",[_._v("根据浏览器类型选择合适的策略")])])]),_._v(" "),v("p",[_._v("（2）编写合理的CSS")]),_._v(" "),v("ul",[v("li",[v("p",[_._v("DOM的深度尽量浅")])]),_._v(" "),v("li",[v("p",[_._v("使用合法的CSS属性")])]),_._v(" "),v("li",[v("p",[_._v("不要为ID选择器指定类名或标签名")])]),_._v(" "),v("li",[v("p",[_._v("避免使用后代选择器，尽量使用子选择器")])]),_._v(" "),v("li",[v("p",[_._v("避免使用通配符")])])]),_._v(" "),v("p",[_._v("（3）关于JS标签")]),_._v(" "),v("p",[_._v("js标签的加载和执行特点：载入后立即执行，执行时会阻塞页面后续内容")]),_._v(" "),v("ul",[v("li",[v("p",[_._v("将所有的js标签放在页面底部，保证脚本执行前已完成DOM渲染")])]),_._v(" "),v("li",[v("p",[_._v("尽可能合并脚本")])]),_._v(" "),v("li",[v("p",[_._v("减少内联js的使用")])]),_._v(" "),v("li",[v("p",[_._v("注意多个js标签的引入顺序")])]),_._v(" "),v("li",[v("p",[_._v("使用defer属性，该属性可以使脚本在文档完全呈现以后再执行")])]),_._v(" "),v("li",[v("p",[_._v("使用async属性，可以使当前脚本不必等待其他脚本的执行，也不必阻塞文档的呈现")])])]),_._v(" "),v("h2",{attrs:{id:"_3-11-browser进程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-11-browser进程"}},[_._v("#")]),_._v(" 3.11.Browser进程")]),_._v(" "),v("ul",[v("li",[_._v("Browser进程收到用户请求，首先需要获取页面内容（譬如通过网络下载资源），随后将该任务通过RendererHost接口传递给Render进程")])]),_._v(" "),v("p",[_._v("Renderer进程的Renderer接口收到消息，简单解释后，交给渲染线程，然后开始渲染")]),_._v(" "),v("p",[_._v("渲染线程接收请求，加载网页并渲染网页，这其中可能需要Browser进程获取资源和需要GPU进程来帮助渲染")]),_._v(" "),v("p",[_._v("当然可能会有JS线程操作DOM（这样可能会造成回流并重绘）")]),_._v(" "),v("p",[_._v("最后Render进程将结果传递给Browser进程")]),_._v(" "),v("p",[_._v("Browser进程接收到结果并将结果绘制出来")])])}),[],!1,null,null,null);v.default=t.exports}}]);