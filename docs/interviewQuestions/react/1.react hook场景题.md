# 1.react hookåœºæ™¯é¢˜

ä¸€ä¸ªçŸ­å°è€Œåˆæ·±åˆ»çš„ React Hook åœºæ™¯é¢˜ï¼Œè¿™ä¸ªä¾‹å­æ¶‰åŠåˆ°ï¼š

* hook é—­åŒ…é—®é¢˜
* state æ›´æ–°æœºåˆ¶

## 1.1.åœºæ™¯å¤ç°

```jsx
<div className="App">
  <button onClick={add}>Add</button>
  {list.map(val => val)}
</div>
```

list æ˜¯ä½¿ç”¨ useState ç®¡ç†çš„çŠ¶æ€ã€‚button ç»‘å®šäº†äº‹ä»¶ onClick={add}ã€‚

ç‚¹å‡»æŒ‰é’®ï¼Œä¼šæ‰§è¡Œ add æ–¹æ³•å‘ list ä¸­åŠ å…¥ä¸€äº›å†…å®¹ã€‚

```jsx
export default function App() {
  const [list, setList] = useState([]);

  const add = () => {
    // ...
  };

  return (
    <div className="App">
      <button onClick={add}>Add</button>
      {list.map(val => val)}
    </div>
  );
}
```

åœ¨ App å¤–éƒ¨å®šä¹‰å˜é‡ i

æ¥ç€é‡ç‚¹æ¥çœ‹çœ‹ add æ–¹æ³•ã€‚

è°ƒç”¨ addï¼Œä¼šå‘ list ä¸­æ·»åŠ æ–°çš„ buttonï¼Œæ–° button ä¹Ÿç»‘å®šäº† onClick={add}ã€‚

```
const add = () => {
  setList(
    list.concat(
      <button 
        key={i} 
        onClick={add}>
        {i++}
      </button>
    )
  );
};
```

å½“æˆ‘ä»¬ç‚¹å‡»ã€ŒAdd æŒ‰é’®ã€7 æ¬¡ï¼Œä¼šå±•ç¤ºï¼š

## 1.2.é—®é¢˜

* ç°åœ¨é—®é¢˜æ¥äº†ï¼šç°åœ¨æˆ‘ä»¬ç‚¹å‡»è¿™äº›ã€Œæ•°å­—æŒ‰é’®ã€ï¼Œé¡µé¢ä¼šæ€ä¹ˆå±•ç¤ºå‘¢

æ¯”å¦‚ç‚¹å‡» 0ï¼Œé¡µé¢ä¼šå¦‚ä½•å±•ç¤ºï¼Œlist æœ€ç»ˆç»“æœæ˜¯ä»€ä¹ˆ

ç‚¹å‡» 6ï¼Œåˆä¼šå¦‚ä½•å±•ç¤º

ä½ å¯ä»¥å…ˆåœä¸‹æ¥æ€è€ƒä¸€ä¸‹ï¼Œå†ç»§ç»­å¾€ä¸‹è¯»ã€‚

## 1.3.è§£ç­”

æœ‰çš„åŒå­¦å¯èƒ½ä¼šè®¤ä¸ºï¼Œç‚¹å‡»ã€Œæ•°å­—æŒ‰é’®ã€åï¼Œä¼šæœ‰æ–°çš„ button è¢«æ·»åŠ åˆ° list ä¸­ã€‚

å…ˆè¯´ç»“è®ºï¼Œè¿™ä¸ªç­”æ¡ˆå¹¶ä¸æ­£ç¡®ã€‚

çœŸæ­£çš„ç°è±¡æ˜¯ï¼Œç‚¹å‡»æ•°å­—æŒ‰é’®åï¼š

åˆ—è¡¨çš„é•¿åº¦å°†ä¼šå˜æˆ ç‚¹å‡»çš„æ•°å­— + 1
* å¹¶ä¸”åˆ—è¡¨æœ€åä¸€ä¸ªæ•°å­—ä¼šå˜æˆ ç‚¹å‡»ä¹‹å‰æœ€å¤§çš„æ•°å­— + 1ã€‚
* æ–‡å­—ä¸å¤ªå®¹æ˜“ç†è§£ï¼Œä¸¾ä¸€ä¸ªğŸŒ°ã€‚

å‡è®¾å½“å‰åˆ—è¡¨æœ‰7ä¸ªæ–°å¢

æˆ‘ä»¬ç‚¹å‡» 0ï¼š
* åˆ—è¡¨çš„é•¿åº¦ä¼šå˜æˆ 0 + 1 = 1
* åˆ—è¡¨æœ€åä¸€ä¸ªæ•°å­—ä¼šå˜æˆ 1 + 1 = 7

å¦‚æœç‚¹å‡» 2ï¼š
* åˆ—è¡¨é•¿åº¦ä¼šå˜æˆ 2 + 1 = 3
* åˆ—è¡¨æœ€åä¸€ä¸ªæ•°å­—ä¼šå˜æ¬¡ 6 + 1 = 7

## 1.4.åŸç†å‰–æ

é€ æˆè¿™ç§åç›´è§‰ç°è±¡çš„åŸå› æœ‰ä¸¤ä¸ªï¼š

1. hook é—­åŒ…é—®é¢˜
2. state æ›´æ–°æœºåˆ¶

å†æ¥çœ‹çœ‹ç‚¹å‡»æŒ‰é’®ä¼šè°ƒç”¨çš„ add å‡½æ•°ï¼š

```jsx
const add = () => {
  setList(
    list.concat(
      <button 
        key={i} 
        onClick={add}>
        {i++}
      </button>
    )
  );
};
```

å½“æ‰§è¡Œ add å‡½æ•°æ—¶ï¼Œç”±äºè®¿é—®äº†å¤–å±‚å‡½æ•° App å†…çš„å˜é‡ï¼Œæ‰€ä»¥ä¼šæ ¹æ® App å‡½æ•°ä¸Šä¸‹æ–‡å½¢æˆé—­åŒ…ï¼Œé—­åŒ…å†…åŒ…æ‹¬ï¼š

* add å‡½æ•°
* list å˜é‡
* setList æ–¹æ³•

list å’Œ setList æ˜¯è°ƒç”¨ useState() è¿”å›çš„ã€‚

è¿™é‡Œé€šå¸¸æœ‰ä¸€ä¸ªè¯¯è§£ï¼šå¤šæ¬¡è°ƒç”¨ useStateï¼Œè¿”å›çš„ list éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚

å®é™…ä¸Šï¼ŒuseState è¿”å›çš„ list éƒ½æ˜¯åŸºäº base state è®¡ç®—å‡ºæ¥çš„ï¼š

```js
current state = base state + update1 + update2 + â€¦
```

æ¯æ¬¡ä¼šå°†ä¸Šä¸€æ¬¡çš„ prev state ä¸ update è¿›è¡Œåˆå¹¶å¾—åˆ°æ–°çš„ current stateã€‚

å› æ­¤ï¼Œæ¯æ¬¡è°ƒç”¨ useState è¿”å›çš„ list éƒ½ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä»¬çš„å†…å­˜åœ°å€ä¸åŒã€‚

è¿™ä¼šå¯¼è‡´æ¯ä¸ªã€Œæ•°å­—æŒ‰é’®ã€çš„ add å‡½æ•°å¤„äºä¸åŒçš„é—­åŒ…ä¸­ï¼Œæ¯ä¸ªé—­åŒ…å½“ä¸­çš„ list éƒ½ä¸åŒã€‚

è€Œå˜é‡ i æ˜¯å£°æ˜åœ¨ App å¤–å±‚çš„æ¨¡å—çº§å˜é‡ï¼Œåœ¨æ¯ä¸ªé—­åŒ…ä¸­ i éƒ½æ˜¯ç›¸åŒçš„ã€‚

æ‰€ä»¥ï¼Œåœ¨ç‚¹å‡» 0 æ—¶ï¼š

* i æ˜¯æ¨¡å—çº§å˜é‡ï¼Œå€¼ä¸º 6
* list æ˜¯é—­åŒ…ä¸­çš„å˜é‡ï¼Œå€¼ä¸º []

add å‡½æ•°å®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ï¼š

```js
setList(
  [].concat(
    <button key={7} onClick={add}>{7}</button>
  )
);
```

æ‰€ä»¥ list æœ€ç»ˆå˜æˆäº† [0, 1, 7]ã€‚

> ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œè¿™é‡Œçš„ [0, 1, 7] çœç•¥äº†å¤–å±‚çš„ <button> æ ‡ç­¾

## 1.5.å¦‚ä½•è§£å†³

é‚£ä¹ˆå¦‚ä½•è§£å†³è¿™ä¸ªé—­åŒ…é—®é¢˜ï¼Œåœ¨ list åé¢æ­£å¸¸æ‹¼æ¥ button å‘¢ï¼Ÿ

å¾ˆç®€å•ï¼Œåªè¦å°† list ä»é—­åŒ…ä¸­æ¸…ç†å‡ºå»å°±å¯ä»¥äº†ï¼Œå°† setList å‚æ•°æ”¹ä¸ºå‡½æ•°å½¢å¼ã€‚

ä¹‹å‰æ˜¯ï¼š

```jsx
setList(
  list.concat(
    <button 
      key={i} 
      onClick={add}>
      {i++}
    </button>
  )
);
```

ä¿®æ”¹ä¸º

```jsx
setList(list => 
  list.concat(
    <button 
      key={i} 
      onClick={add}>
      {i++}
    </button>
  )
);
```

è¿™æ ·ï¼Œæˆ‘ä»¬ç‚¹å‡»ã€ŒAdd æŒ‰é’®ã€æˆ–ä»»æ„ã€Œæ•°å­—æŒ‰é’®ã€éƒ½ä¼šæ­£å¸¸åœ¨ list åé¢æ‹¼æ¥æ–°æŒ‰é’®ã€‚

## 1.6.æ€»ç»“

ç”±äº state çš„æ›´æ–°æœºåˆ¶æ˜¯ï¼š

```
current state = base state + update1 + update2 + â€¦
```

æ‰€ä»¥æ¯æ¬¡è°ƒç”¨ useStateï¼Œè¿”å›å€¼ list éƒ½æ˜¯ä¸åŒçš„å¯¹è±¡ã€‚

å¹¶ä¸”ç”±äºé—­åŒ…çš„å­˜åœ¨ï¼Œæ¯ä¸ªã€Œæ•°å­—æŒ‰é’®ã€add å‡½æ•°ä¸­çš„ list éƒ½ä¸åŒã€‚

ä¸¤è€…å…±åŒä½œç”¨ï¼Œé€ æˆäº†è¿™ç§ä¸ç¬¦åˆç›´è§‰çš„ç°è±¡ã€‚

å¦‚ä½•è§£å†³è¿™ç§é—­åŒ…é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å°† setState æ”¹ä¸ºå‡½æ•°å½¢å¼ï¼Œå°†å˜é‡ä»é—­åŒ…ä¸­æ¸…ç†å‡ºå»ã€‚

* æ¥æºï¼š

https://mp.weixin.qq.com/s?__biz=MzUxODc0ODQ1NA==&mid=2247491841&idx=1&sn=5f95dea46bb690117192aedb29fdc582&chksm=f9868148cef1085edafccf082da89ac9355707f4793bc33ef34cf913335a89610df96107a9ce&mpshare=1&scene=1&srcid=1114llnJjVhyIW1g7mDg94tf&sharer_sharetime=1668399165851&sharer_shareid=eff40bbfe5781ffafe52026aa4765d4d#rd

